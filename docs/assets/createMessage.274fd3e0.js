import{A as n}from"./index.a9c20b32.js";import{E as z}from"./el-overlay.a9414acf.js";import{E as G}from"./el-button.a91e83f6.js";import{E as J,a as P}from"./el-form-item.ef652a72.js";import{E as Q}from"./el-input.50d72e9c.js";import"./el-tag.7c2e4455.js";import{E as W,a as X}from"./el-select.cb0e3f15.js";import{T as Y,E as Z}from"./index.esm.37433279.js";import{b as C}from"./mitt.dc7cd694.js";import{p as V,e as h}from"./message.a74655c9.js";import{e as ee}from"./setting.acd96df6.js";import{u as ue,d as ae}from"./message.e70da8d9.js";import{_ as se,d as te,h as p,ae as x,i as k,ay as le,B as oe,s as re,o as m,$ as _,w as r,e as E,j as l,a as me,c as U,F as M,ax as j,b,u as q}from"./index.ea4bb737.js";import"./focus-trap.81366787.js";import"./use-form-item.94301b5b.js";import"./castArray.11eccfc8.js";import"./_baseClone.98dedeff.js";import"./_initCloneObject.9d0b46bd.js";import"./strings.7bfc8dd9.js";const ne={class:"dialog-content"},de={style:{border:"1px solid #ccc"}},ie={class:"dialog-footer"},ge=te({__name:"createMessage",emits:["success"],setup(_e,{expose:N,emit:R}){const d=p(!1),w=ue(),I=()=>{e.message_title="",e.message_publish_department="",e.message_publish_name=localStorage.getItem("name"),e.message_category="",e.message_receipt_object="",e.message_level="",e.message_content=""};x(()=>{C.all.clear()}),x(()=>{const u=f.value;u!=null&&u.destroy()});const v=p([]),D=p([]);(async()=>{const u=await ee();v.value=u.data;const s=u.data.slice();s.push("\u5168\u4F53\u6210\u5458"),D.value=s})();const B=p(),e=k({id:null,message_title:"",message_publish_department:"",message_publish_name:localStorage.getItem("name"),message_category:"",message_receipt_object:"",message_level:"",message_content:""}),L=k({message_title:[{required:!0,message:"\u8BF7\u8F93\u5165\u516C\u544A\u6807\u9898",trigger:"blur"}],message_publish_department:[{required:!0,message:"\u8BF7\u9009\u62E9\u53D1\u5E03\u90E8\u95E8",trigger:"blur"}],message_publish_name:[{required:!0,message:"\u8BF7\u8F93\u5165\u53D1\u5E03\u4EBA",trigger:"blur"}],message_receipt_object:[{required:!0,message:"\u8BF7\u9009\u62E9\u7684\u63A5\u6536\u5BF9\u8C61",trigger:"blur"}],message_level:[{required:!0,message:"\u8BF7\u9009\u62E9\u516C\u544A\u7B49\u7EA7",trigger:"blur"}],message_content:[{required:!0,message:"\u8BF7\u8F93\u5165\u516C\u544A\u5185\u5BB9",trigger:"blur"}],message_category:[{required:!0,message:"\u8BF7\u9009\u62E9\u516C\u544A\u7C7B\u522B",trigger:"blur"}]}),t=p();C.on("createMessageName",u=>{t.value=u,t.value==="\u53D1\u5E03\u516C\u53F8\u516C\u544A"&&(e.message_category="\u516C\u53F8\u516C\u544A"),t.value==="\u53D1\u5E03\u7CFB\u7EDF\u6D88\u606F"&&(e.message_category="\u7CFB\u7EDF\u6D88\u606F")}),C.on("editMessage",async u=>{u=le(u),await oe(()=>{t.value="\u7F16\u8F91"+u.message_category,e.id=u.id,e.message_title=u.message_title,e.message_publish_department=u.message_publish_department,e.message_publish_name=u.message_publish_name,e.message_category=u.message_category,e.message_receipt_object=u.message_receipt_object,e.message_level=u.message_level,e.message_content=u.message_content})});const f=re(),y=p("default"),A={excludeKeys:[]},S={placeholder:"",MENU_CONF:{}};A.excludeKeys=["blockquote","bgColor","color","group-more-style","fontFamily","bulletedList","numberedList","lineHeight","todo","emotion","insertLink","group-video","insertTable","codeBlock","divider","fullScreen","group-image"];const T=u=>{f.value=u},c=R,O=async u=>{!u||await u.validate(async s=>{if(s){if(t.value=="\u53D1\u5E03\u516C\u53F8\u516C\u544A"){const o=await V(e);await ae(o.data.id,o.data.department),w.returnReadList(localStorage.getItem("id")),o.data.status===0?(n({message:o.data.message,type:"success"}),d.value=!1,c("success")):n.error("\u53D1\u5E03\u516C\u53F8\u516C\u544A\u5931\u8D25\uFF01")}if(t.value=="\u53D1\u5E03\u7CFB\u7EDF\u6D88\u606F"){const o=await V(e);o.data.status===0?(n({message:o.data.message,type:"success"}),d.value=!1,c("success")):n.error("\u53D1\u5E03\u7CFB\u7EDF\u6D88\u606F\u5931\u8D25\uFF01")}if(t.value=="\u7F16\u8F91\u516C\u53F8\u516C\u544A"){const o=await h(e);o.data.status===0?(n({message:o.data.message,type:"success"}),d.value=!1,c("success")):n.error("\u7F16\u8F91\u516C\u53F8\u516C\u544A\u5931\u8D25\uFF01")}if(t.value=="\u7F16\u8F91\u7CFB\u7EDF\u6D88\u606F"){const o=await h(e);o.data.status===0?(n({message:o.data.message,type:"success"}),d.value=!1,c("success")):n.error("\u7F16\u8F91\u7CFB\u7EDF\u6D88\u606F\u5931\u8D25\uFF01")}}})};return N({open:()=>{d.value=!0}}),(u,s)=>{const o=Q,i=J,g=W,F=X,K=P,$=G,H=z;return m(),_(H,{modelValue:d.value,"onUpdate:modelValue":s[8]||(s[8]=a=>d.value=a),title:t.value,width:"50%",center:"","align-center":"","append-to-body":"",onClose:I},{footer:r(()=>[E("span",ie,[l($,{type:"primary",onClick:s[7]||(s[7]=a=>O(B.value))},{default:r(()=>[me(" \u786E\u5B9A ")]),_:1})])]),default:r(()=>[E("div",ne,[l(K,{ref_key:"messageRef",ref:B,model:e,rules:L,"label-width":"100px",style:{"max-width":"700px"}},{default:r(()=>[l(i,{label:"\u4E3B\u9898",prop:"message_title"},{default:r(()=>[l(o,{modelValue:e.message_title,"onUpdate:modelValue":s[0]||(s[0]=a=>e.message_title=a),placeholder:"\u8BF7\u8F93\u5165\u4E3B\u9898"},null,8,["modelValue"])]),_:1}),t.value==="\u53D1\u5E03\u516C\u53F8\u516C\u544A"||t.value==="\u7F16\u8F91\u516C\u544A"?(m(),_(i,{key:0,label:"\u53D1\u5E03\u90E8\u95E8",prop:"message_publish_department"},{default:r(()=>[t.value==="\u53D1\u5E03\u516C\u53F8\u516C\u544A"||t.value==="\u7F16\u8F91\u516C\u544A"?(m(),_(F,{key:0,modelValue:e.message_publish_department,"onUpdate:modelValue":s[1]||(s[1]=a=>e.message_publish_department=a),placeholder:"\u8BF7\u8F93\u5165\u53D1\u5E03\u90E8\u95E8"},{default:r(()=>[(m(!0),U(M,null,j(v.value,a=>(m(),_(g,{key:a,label:a,value:a},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):b("",!0)]),_:1})):b("",!0),l(i,{label:"\u53D1\u5E03\u4EBA",prop:"message_publish_name"},{default:r(()=>[l(o,{modelValue:e.message_publish_name,"onUpdate:modelValue":s[2]||(s[2]=a=>e.message_publish_name=a),disabled:""},null,8,["modelValue"])]),_:1}),l(i,{label:"\u6D88\u606F\u7C7B\u522B",prop:"message_category"},{default:r(()=>[l(F,{modelValue:e.message_category,"onUpdate:modelValue":s[3]||(s[3]=a=>e.message_category=a),placeholder:"\u8BF7\u9009\u62E9\u6D88\u606F\u7C7B\u522B"},{default:r(()=>[l(g,{disabled:t.value!="\u53D1\u5E03\u516C\u53F8\u516C\u544A",label:"\u516C\u53F8\u516C\u544A",value:"\u516C\u53F8\u516C\u544A"},null,8,["disabled"]),l(g,{disabled:t.value!="\u53D1\u5E03\u7CFB\u7EDF\u6D88\u606F",label:"\u7CFB\u7EDF\u6D88\u606F",value:"\u7CFB\u7EDF\u6D88\u606F"},null,8,["disabled"])]),_:1},8,["modelValue"])]),_:1}),t.value==="\u53D1\u5E03\u516C\u53F8\u516C\u544A"||t.value==="\u7F16\u8F91\u516C\u53F8\u516C\u544A"?(m(),_(i,{key:1,label:"\u63A5\u6536\u90E8\u95E8",prop:"message_receipt_object"},{default:r(()=>[l(F,{modelValue:e.message_receipt_object,"onUpdate:modelValue":s[4]||(s[4]=a=>e.message_receipt_object=a),placeholder:"\u8BF7\u9009\u62E9\u63A5\u6536\u90E8\u95E8"},{default:r(()=>[(m(!0),U(M,null,j(D.value,a=>(m(),_(g,{key:a,label:a,value:a},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):b("",!0),t.value==="\u53D1\u5E03\u516C\u53F8\u516C\u544A"||t.value==="\u7F16\u8F91\u516C\u53F8\u516C\u544A"?(m(),_(i,{key:2,label:"\u516C\u544A\u7B49\u7EA7",prop:"message_level"},{default:r(()=>[l(F,{modelValue:e.message_level,"onUpdate:modelValue":s[5]||(s[5]=a=>e.message_level=a),placeholder:"\u8BF7\u9009\u62E9\u516C\u544A\u7B49\u7EA7"},{default:r(()=>[l(g,{label:"\u4E00\u822C",value:"\u4E00\u822C"}),l(g,{label:"\u91CD\u8981",value:"\u91CD\u8981"}),l(g,{label:"\u5FC5\u8981",value:"\u5FC5\u8981"})]),_:1},8,["modelValue"])]),_:1})):b("",!0),l(i,{label:"\u5185\u5BB9",prop:"message_content"},{default:r(()=>[E("div",de,[l(q(Y),{style:{"border-bottom":"1px solid #ccc"},editor:f.value,defaultConfig:A,mode:y.value},null,8,["editor","mode"]),l(q(Z),{style:{height:"300px","overflow-y":"hidden"},modelValue:e.message_content,"onUpdate:modelValue":s[6]||(s[6]=a=>e.message_content=a),defaultConfig:S,mode:y.value,onOnCreated:T},null,8,["modelValue","mode"])])]),_:1})]),_:1},8,["model","rules"])])]),_:1},8,["modelValue","title"])}}});var Re=se(ge,[["__scopeId","data-v-83b9d134"]]);export{Re as default};
