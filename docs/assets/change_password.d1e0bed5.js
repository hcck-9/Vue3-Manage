import{A as p}from"./index.a9c20b32.js";import{E as F}from"./el-overlay.a9414acf.js";import{E}from"./el-button.a91e83f6.js";import{E as V,a as h}from"./el-form-item.ef652a72.js";import{E as D}from"./el-input.50d72e9c.js";import{e as C}from"./userinfo.7e0ce5ee.js";import{d as k,k as x,h as y,i as d,o as v,$ as R,w as t,e as b,j as r,a as g}from"./index.ea4bb737.js";import"./focus-trap.81366787.js";import"./use-form-item.94301b5b.js";import"./castArray.11eccfc8.js";import"./_baseClone.98dedeff.js";import"./_initCloneObject.9d0b46bd.js";const A={class:"dialog-footer"},L=k({__name:"change_password",setup(I,{expose:c}){const w=x(),m=y(),o=d({oldPassword:"",newPassword:""}),f=d({oldPassword:[{required:!0,message:"\u8BF7\u8F93\u5165\u4F60\u7684\u65E7\u5BC6\u7801",trigger:"change"}],newPassword:[{required:!0,message:"\u8BF7\u8F93\u5165\u4F60\u7684\u65B0\u5BC6\u7801",trigger:"change"}]}),l=d({changePasswordDialog:!1}),_=async n=>{!n||await n.validate(async e=>{if(e){const u=localStorage.getItem("id"),a=await C(u,o.oldPassword,o.newPassword);a.data.status===0?(p({message:a.data.message,type:"success"}),localStorage.setItem("id",a.data.id),l.changePasswordDialog=!1,w.push("/login")):p.error(a.data.message)}})};return c({open:()=>{l.changePasswordDialog=!0}}),(n,e)=>{const u=D,a=V,P=h,i=E,B=F;return v(),R(B,{modelValue:l.changePasswordDialog,"onUpdate:modelValue":e[4]||(e[4]=s=>l.changePasswordDialog=s),title:"\u5FD8\u8BB0\u5BC6\u7801",width:"400px"},{footer:t(()=>[b("span",A,[r(i,{onClick:e[2]||(e[2]=s=>l.changePasswordDialog=!1)},{default:t(()=>[g("\u53D6\u6D88")]),_:1}),r(i,{type:"primary",onClick:e[3]||(e[3]=s=>_(m.value))},{default:t(()=>[g(" \u786E\u5B9A ")]),_:1})])]),default:t(()=>[r(P,{ref_key:"changePasswordRuleFormRef",ref:m,model:o,rules:f,class:"login-form","label-position":"top"},{default:t(()=>[r(a,{label:"\u8F93\u5165\u60A8\u7684\u65E7\u5BC6\u7801",prop:"oldPassword"},{default:t(()=>[r(u,{modelValue:o.oldPassword,"onUpdate:modelValue":e[0]||(e[0]=s=>o.oldPassword=s)},null,8,["modelValue"])]),_:1}),r(a,{label:"\u8F93\u5165\u60A8\u7684\u65B0\u5BC6\u7801",prop:"newPassword"},{default:t(()=>[r(u,{modelValue:o.newPassword,"onUpdate:modelValue":e[1]||(e[1]=s=>o.newPassword=s)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}}});export{L as default};
